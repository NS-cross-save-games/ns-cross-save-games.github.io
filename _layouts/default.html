<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">

{% seo %}
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    {% include head-custom.html %}
    <style>
      /* Theme Variables */
      :root {
        --bg-color: #f5f5f7;
        --text-color: #1d1d1f;
        --header-bg-start: #159957;
        --header-bg-end: #155799;
        --link-color: #0071e3;
        --link-hover-color: #0077ed;
        --code-bg: #f5f5f5;
        --code-text: #333;
        --border-color: rgba(0, 0, 0, 0.1);
        --section-bg: #ffffff;
        --footer-text: #86868b;
        --toggle-bg: rgba(255, 255, 255, 0.15);
        --toggle-hover-bg: rgba(255, 255, 255, 0.25);
        --toggle-border: rgba(255, 255, 255, 0.3);
        --toggle-text: rgba(255, 255, 255, 0.9);
      }

      [data-theme="dark"] {
        --bg-color: #000000;
        --text-color: #f5f5f7;
        --header-bg-start: #1d1d1f;
        --header-bg-end: #2c2c2e;
        --link-color: #2997ff;
        --link-hover-color: #409cff;
        --code-bg: #1c1c1e;
        --code-text: #f5f5f7;
        --border-color: rgba(255, 255, 255, 0.15);
        --section-bg: #1c1c1e;
        --footer-text: #86868b;
        --toggle-bg: rgba(255, 255, 255, 0.1);
        --toggle-hover-bg: rgba(255, 255, 255, 0.2);
        --toggle-border: rgba(255, 255, 255, 0.3);
        --toggle-text: rgba(255, 255, 255, 0.9);
      }

      body {
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .main-content {
        background-color: var(--section-bg);
        transition: background-color 0.3s ease;
      }

      .main-content h1,
      .main-content h2,
      .main-content h3,
      .main-content h4,
      .main-content h5,
      .main-content h6 {
        color: var(--text-color);
      }

      .main-content a {
        color: var(--link-color);
      }

      .main-content a:hover {
        color: var(--link-hover-color);
      }

      .main-content code {
        background-color: var(--code-bg);
        color: var(--code-text);
        border-color: var(--border-color);
      }

      .main-content pre {
        background-color: var(--code-bg);
        border-color: var(--border-color);
      }

      .main-content pre > code {
        background-color: var(--code-bg);
      }

      .main-content blockquote {
        border-left-color: var(--border-color);
        color: var(--text-color);
      }

      .main-content table td,
      .main-content table th {
        border-color: var(--border-color);
      }

      .site-footer {
        color: var(--footer-text);
      }

      .page-header {
        background: linear-gradient(120deg, var(--header-bg-start), var(--header-bg-end));
        transition: background 0.3s ease;
      }

      .header-controls {
        position: absolute;
        top: 20px;
        right: 20px;
        z-index: 1000;
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .theme-toggle,
      .lang-toggle a {
        color: var(--toggle-text);
        text-decoration: none;
        font-size: 14px;
        padding: 8px 12px;
        border: 1px solid var(--toggle-border);
        border-radius: 8px;
        transition: all 0.3s ease;
        background: var(--toggle-bg);
        display: inline-block;
        cursor: pointer;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      .theme-toggle:hover,
      .lang-toggle a:hover {
        background: var(--toggle-hover-bg);
        border-color: rgba(255, 255, 255, 0.5);
        transform: translateY(-1px);
      }

      .theme-toggle {
        border: none;
        font-size: 20px;
        width: 40px;
        height: 40px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      @media screen and (max-width: 42em) {
        .header-controls {
          top: 10px;
          right: 10px;
          gap: 6px;
        }
        .lang-toggle a {
          font-size: 12px;
          padding: 6px 10px;
        }
        .theme-toggle {
          width: 36px;
          height: 36px;
          font-size: 18px;
        }
      }
    </style>
  </head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <div class="header-controls">
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme" title="Toggle light/dark mode">
          <span class="theme-icon">üåô</span>
        </button>
        <div class="lang-toggle">
          {% if page.lang == 'zh' %}
            <a href="{{ site.baseurl }}/">English</a>
          {% else %}
            <a href="{{ site.baseurl }}/index_zh.html">‰∏≠Êñá</a>
          {% endif %}
        </div>
      </div>
      <h1 class="project-name">{{ page.title | default: site.title | default: site.github.repository_name }}</h1>
      <!-- <h2 class="project-tagline">{{ page.description | default: site.description | default: site.github.project_tagline }}</h2> -->
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span id="busuanzi_container_site_pv">Page Views: <span id="busuanzi_value_site_pv"></span></span>

    </header>

    <main id="content" class="main-content" role="main">
      {{ content }}

      <footer class="site-footer" >
        {% if site.github.is_project_page %}
          <span class="site-footer-owner"><a href="{{ site.github.repository_url }}">{{ site.github.repository_name }}</a> is maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a>.</span>
        {% endif %}
      </footer>
    </main>

    <script>
      // Theme toggle functionality
      (function() {
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.querySelector('.theme-icon');
        const html = document.documentElement;

        // Check for saved theme preference or default to OS preference
        function getInitialTheme() {
          const savedTheme = localStorage.getItem('theme');
          if (savedTheme) {
            return savedTheme;
          }
          // Check OS preference
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
          }
          return 'light';
        }

        // Set theme
        function setTheme(theme) {
          if (theme === 'dark') {
            html.setAttribute('data-theme', 'dark');
            themeIcon.textContent = '‚òÄÔ∏è';
            themeToggle.setAttribute('title', 'Switch to light mode');
          } else {
            html.removeAttribute('data-theme');
            themeIcon.textContent = 'üåô';
            themeToggle.setAttribute('title', 'Switch to dark mode');
          }
          localStorage.setItem('theme', theme);
        }

        // Initialize theme
        const initialTheme = getInitialTheme();
        setTheme(initialTheme);

        // Toggle theme on button click
        themeToggle.addEventListener('click', function() {
          const currentTheme = html.getAttribute('data-theme');
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          setTheme(newTheme);
        });

        // Listen for OS theme changes
        if (window.matchMedia) {
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
            // Only auto-switch if user hasn't manually set a preference
            if (!localStorage.getItem('theme')) {
              setTheme(e.matches ? 'dark' : 'light');
            }
          });
        }
      })();
    </script>
  </body>
</html>